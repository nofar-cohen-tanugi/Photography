import*as e from"react";import{PrimeReactContext as n}from"primereact/api";import{ComponentBase as t,useHandleStyle as r}from"primereact/componentbase";import{SearchIcon as o}from"primereact/icons/search";import{SpinnerIcon as l}from"primereact/icons/spinner";import{classNames as a,mergeProps as i,DomHandler as c,ObjectUtils as d,IconUtils as u}from"primereact/utils";import{CheckIcon as p}from"primereact/icons/check";import{ChevronDownIcon as s}from"primereact/icons/chevrondown";import{ChevronRightIcon as f}from"primereact/icons/chevronright";import{MinusIcon as g}from"primereact/icons/minus";import{Ripple as m}from"primereact/ripple";function h(){return h=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h.apply(this,arguments)}function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function v(e){if(Array.isArray(e))return y(e)}function b(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function x(e,n){if(e){if("string"==typeof e)return y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,n):void 0}}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e){return v(e)||b(e)||x(e)||S()}function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function C(e,n){if("object"!==k(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function I(e){var n=C(e,"string");return"symbol"===k(n)?n:String(n)}function D(e,n,t){return(n=I(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function w(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,l,a,i=[],c=!0,d=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=l.call(t)).done)&&(i.push(r.value),i.length!==n);c=!0);}catch(e){d=!0,o=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(d)throw o}}return i}}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,n){return O(e)||w(e,n)||x(e,n)||T()}var K=t.extend({defaultProps:{__TYPE:"Tree",__parentMetadata:null,id:null,value:null,checkboxIcon:null,disabled:!1,selectionMode:null,selectionKeys:null,onSelectionChange:null,contextMenuSelectionKey:null,onContextMenuSelectionChange:null,expandedKeys:null,ariaLabel:null,ariaLabelledBy:null,style:null,className:null,contentStyle:null,contentClassName:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,loading:!1,loadingIcon:null,expandIcon:null,collapseIcon:null,dragdropScope:null,header:null,footer:null,showHeader:!0,filter:!1,filterIcon:null,filterValue:null,filterBy:"label",filterMode:"lenient",filterPlaceholder:null,filterLocale:void 0,filterTemplate:null,level:0,nodeTemplate:null,togglerTemplate:null,onSelect:null,onUnselect:null,onExpand:null,onCollapse:null,onToggle:null,onDragDrop:null,onContextMenu:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,children:void 0},css:{classes:{container:"p-tree-container",loadingIcon:"p-tree-loading-icon",loadingOverlay:"p-tree-loading-overlay p-component-overlay",searchIcon:"p-tree-filter-icon",filterContainer:"p-tree-filter-container",input:"p-tree-filter p-inputtext p-component",header:"p-tree-header",footer:"p-tree-footer",root:function(e){var n=e.props;return a("p-tree p-component",{"p-tree-selectable":n.selectionMode,"p-tree-loading":n.loading,"p-disabled":n.disabled})},label:"p-treenode-label",checkboxIcon:"p-checkbox-icon p-c",checkboxContainer:"p-checkbox p-component",checkbox:function(e){return a("p-checkbox-box",{"p-highlight":e.checked,"p-indeterminate":e.partialChecked,"p-disabled":e.nodeProps.disabled})},nodeIcon:"p-treenode-icon",togglerIcon:"p-tree-toggler-icon",toggler:"p-tree-toggler p-link",droppoint:"p-treenode-droppoint",content:function(e){var n=e.nodeProps,t=e.checked,r=e.selected;return a("p-treenode-content",{"p-treenode-selectable":n.selectionMode&&!1!==n.node.selectable,"p-highlight":(0,e.isCheckboxSelectionMode)()?t:r,"p-highlight-contextmenu":n.contextMenuSelectionKey&&n.contextMenuSelectionKey===n.node.key,"p-disabled":n.disabled})},subgroup:"p-treenode-children",node:function(e){return a("p-treenode",{"p-treenode-leaf":e.isLeaf})}},styles:"\n@layer primereact {\n    .p-tree-container {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n        overflow: auto;\n    }\n\n    .p-treenode-children {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n    }\n\n    .p-treenode-selectable {\n        cursor: pointer;\n        user-select: none;\n    }\n\n    .p-tree-toggler {\n        cursor: pointer;\n        user-select: none;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-treenode-leaf > .p-treenode-content .p-tree-toggler {\n        visibility: hidden;\n    }\n\n    .p-treenode-content {\n        display: flex;\n        align-items: center;\n    }\n\n    .p-tree-filter {\n        width: 100%;\n    }\n\n    .p-tree-filter-container {\n        position: relative;\n        display: block;\n        width: 100%;\n    }\n\n    .p-tree-filter-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n\n    .p-tree-loading {\n        position: relative;\n        min-height: 4rem;\n    }\n\n    .p-tree .p-tree-loading-overlay {\n        position: absolute;\n        z-index: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n}\n"}});function M(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=P(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function P(e,n){if(e){if("string"==typeof e)return j(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?j(e,n):void 0}}function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var L=e.memo((function(n){var t,r,o,l,h,y,v,b=e.useRef(null),x=e.useRef(null),S=e.useRef(!1),k=n.isNodeLeaf(n.node),C=n.node.label,I=!!n.expandedKeys&&void 0!==n.expandedKeys[n.node.key]||n.node.expanded,O=n.ptm,w=n.cx,T=function(e){return O(e,{hostName:n.hostName,context:{selected:!ie()&&te(),expanded:I||!1,checked:!!ie()&&re(),isLeaf:k}})},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.expandedKeys?U({},n.expandedKeys):{};r[n.node.key]=!0,n.onToggle({originalEvent:e,value:r,navigateFocusToChild:t}),j(e,!0)},K=function(e){var t=U({},n.expandedKeys);delete t[n.node.key],n.onToggle({originalEvent:e,value:t}),j(e,!1)},P=function(e){n.disabled||(I?K(e):N(e,!1),e.preventDefault(),e.stopPropagation())},j=function(e,t){t?n.onExpand&&n.onExpand({originalEvent:e,node:n.node}):n.onCollapse&&n.onCollapse({originalEvent:e,node:n.node})},A=function e(n){var t=F(n);return t?t.nextElementSibling||e(t):null},R=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},F=function(e){var n=e.parentElement.parentElement;return c.hasClass(n,"p-treenode")?n:null},J=function(e){n.onClick&&n.onClick({originalEvent:e,node:n.node});var t=e.target.nodeName;if(!n.disabled&&"INPUT"!==t&&"BUTTON"!==t&&"A"!==t&&!c.hasClass(e.target,"p-clickable")){if(n.selectionMode&&!1!==n.node.selectable){var r;if(ie()){var o=re();r=n.selectionKeys?U({},n.selectionKeys):{},o?(n.propagateSelectionDown?ne(n.node,!1,r):delete r[n.node.key],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!1,selectionKeys:r}),n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(n.propagateSelectionDown?ne(n.node,!0,r):r[n.node.key]={checked:!0},n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!0,selectionKeys:r}),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else{var l=te();if(!S.current&&n.metaKeySelection){var a=e.metaKey||e.ctrlKey;l&&a?(le()?r=null:delete(r=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(le()?r=n.node.key:ae()&&((r=a&&n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else le()?l?(r=null,n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(r=n.node.key,n.onSelect&&n.onSelect({originalEvent:e,node:n.node})):l?(delete(r=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):((r=n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0,n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}n.onSelectionChange&&n.onSelectionChange({originalEvent:e,value:r})}S.current=!1}},X=function(e){n.onDoubleClick&&n.onDoubleClick({originalEvent:e,node:n.node})},B=function(e){n.disabled||(c.clearSelection(),n.onContextMenuSelectionChange&&n.onContextMenuSelectionChange({originalEvent:e,value:n.node.key}),n.onContextMenu&&n.onContextMenu({originalEvent:e,node:n.node}))},V=function(e){if(oe(e))switch(e.code){case"Tab":q();break;case"ArrowDown":_(e);break;case"ArrowUp":H(e);break;case"ArrowRight":$(e);break;case"ArrowLeft":z(e);break;case"Enter":case"NumpadEnter":case"Space":Y(e)}},_=function(e){var n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1];if(t)W(n,t.children[0]);else if(n.nextElementSibling)W(n,n.nextElementSibling);else{var r=A(n);r&&W(n,r)}e.preventDefault()},H=function(e){var n=e.target;if(n.previousElementSibling)W(n,n.previousElementSibling,R(n.previousElementSibling));else{var t=F(n);t&&W(n,t)}e.preventDefault()},$=function(e){k||I||(e.currentTarget.tabIndex=-1,N(e,!0))},z=function(e){var t=c.findSingle(e.currentTarget,'[data-pc-section="toggler"]');if(0===n.level&&!I)return!1;if(I&&!k)return t.click(),!1;var r=Z(e.currentTarget);r&&W(e.currentTarget,r)},Y=function(e){Q(e,S.current),J(e),e.preventDefault()},q=function(){G()},G=function(){var e=c.find(b.current.closest('[data-pc-section="container"]'),'[role="treeitem"]'),n=E(e).some((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));if(E(e).forEach((function(e){e.tabIndex=-1})),n){var t=E(e).filter((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));t[0].tabIndex=0}else E(e)[0].tabIndex=0},Q=function(e,t){if(null!==n.selectionMode){var r=E(c.find(x.current.parentElement,'[role="treeitem"]'));e.currentTarget.tabIndex=!1===t?-1:0,r.every((function(e){return-1===e.tabIndex}))&&(r[0].tabIndex=0)}},W=function(e,n,t){var r;e.tabIndex="-1",n.tabIndex="0",(r=t||n)&&r.focus()},Z=function e(n){var t=n.closest("ul").closest("li");if(t){var r=c.findSingle(t,"button");return r&&"hidden"!==r.style.visibility?t:e(n.previousElementSibling)}return null},ee=function(e){var t,r=e.check,o=e.selectionKeys,l=M(n.node.children);try{for(l.s();!(t=l.n()).done;){var a=t.value;o[a.key]&&o[a.key].checked&&0}}catch(e){l.e(e)}finally{l.f()}var i=n.node.key,c=d.findChildrenByKey(n.originalOptions,i),u=c.some((function(e){return e.key in o})),p=c.every((function(e){return e.key in o&&o[e.key].checked}));u&&!p?o[i]={checked:!1,partialChecked:!0}:p?o[i]={checked:!0,partialChecked:!1}:r?o[i]={checked:!1,partialChecked:!1}:delete o[i],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp(e)},ne=function e(n,t,r){if(t?r[n.key]={checked:!0,partialChecked:!1}:delete r[n.key],n.children&&n.children.length)for(var o=0;o<n.children.length;o++)e(n.children[o],t,r)},te=function(){return!(!n.selectionMode||!n.selectionKeys)&&(le()?n.selectionKeys===n.node.key:void 0!==n.selectionKeys[n.node.key])},re=function(){return!!n.selectionKeys&&(n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].checked)||!1},oe=function(e){return e.currentTarget&&(e.currentTarget.isSameNode(e.target)||e.currentTarget.isSameNode(e.target.closest('[role="treeitem"]')))},le=function(){return n.selectionMode&&"single"===n.selectionMode},ae=function(){return n.selectionMode&&"multiple"===n.selectionMode},ie=function(){return n.selectionMode&&"checkbox"===n.selectionMode},ce=function(){S.current=!0},de=function(e,t){(e.preventDefault(),!1!==n.node.droppable)&&(c.removeClass(e.target,"p-treenode-droppoint-active"),n.onDropPoint&&n.onDropPoint({originalEvent:e,path:n.path,index:-1===t?n.index:n.index+1,position:t}))},ue=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},pe=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&c.addClass(e.target,"p-treenode-droppoint-active")},se=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&c.removeClass(e.target,"p-treenode-droppoint-active")},fe=function(e){n.dragdropScope&&!1!==n.node.droppable&&(c.removeClass(b.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),n.onDrop&&n.onDrop({originalEvent:e,path:n.path,index:n.index}))},ge=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},me=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&c.addClass(b.current,"p-treenode-dragover")},he=function(e){if(e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable){var t=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>t.left+t.width||e.nativeEvent.x<t.left||e.nativeEvent.y>=Math.floor(t.top+t.height)||e.nativeEvent.y<t.top)&&c.removeClass(b.current,"p-treenode-dragover")}},ye=function(e){e.dataTransfer.setData("text",n.dragdropScope),e.dataTransfer.setData(n.dragdropScope,n.dragdropScope),n.onDragStart&&n.onDragStart({originalEvent:e,path:n.path,index:n.index})},ve=function(e){n.onDragEnd&&n.onDragEnd({originalEvent:e})},be=function(){var t=i({className:w("label")},T("label")),r=e.createElement("span",t,C);n.nodeTemplate&&(r=d.getJSXElement(n.nodeTemplate,n.node,{onTogglerClick:P,className:"p-treenode-label",element:r,props:n,expanded:I}));return r},xe=function(){if(ie()&&!1!==n.node.selectable){var t=re(),r=!!n.selectionKeys&&n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].partialChecked,o=i({className:w("checkboxIcon")},T("checkboxIcon")),l=u.getJSXIcon(t?n.checkboxIcon||e.createElement(p,o):r?n.checkboxIcon||e.createElement(g,o):null,U({},o),n),a=i({"aria-hidden":!0,className:w("checkboxContainer")},T("checkboxContainer")),c=i({className:w("checkbox",{checked:t,partialChecked:r,nodeProps:n}),role:"checkbox"},T("checkbox"));return e.createElement("div",a,e.createElement("div",c,l))}return null},Se=function(){var t=n.node.icon||(I?n.node.expandedIcon:n.node.collapsedIcon);if(t){var r=i({className:a(t,w("nodeIcon"))},T("nodeIcon"));return e.createElement("span",r)}return null},Ee=function(){var t=i({className:w("togglerIcon"),"aria-hidden":!0},T("togglerIcon")),r=u.getJSXIcon(I?n.collapseIcon||e.createElement(s,t):n.expandIcon||e.createElement(f,t),U({},t),{props:n,expanded:I}),o=i({type:"button",className:w("toggler"),tabIndex:-1,"aria-hidden":!0,onClick:P},T("toggler")),l=e.createElement("button",o,r,e.createElement(m,null));n.togglerTemplate&&(l=d.getJSXElement(n.togglerTemplate,n.node,{onClick:P,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:l,props:n,expanded:I}));return l},ke=function(t){if(n.dragdropScope){var r=i({className:w("droppoint"),onDrop:function(e){return de(e,t)},onDragOver:ue,onDragEnter:pe,onDragLeave:se},T("droppoint"));return e.createElement("li",r)}return null},Ce=function(){var t=te(),r=re(),o=Ee(),l=xe(),c=Se(),d=be(),u=i({ref:b,className:a(n.node.className,w("content",{checked:r,selected:t,nodeProps:n,isCheckboxSelectionMode:ie})),style:n.node.style,onClick:J,onDoubleClick:X,onContextMenu:B,onTouchEnd:ce,draggable:n.dragdropScope&&!1!==n.node.draggable&&!n.disabled,onDrop:fe,onDragOver:ge,onDragEnter:me,onDragLeave:he,onDragStart:ye,onDragEnd:ve},T("content"));return e.createElement("div",u,o,l,c,d)},Ie=(r=n.disabled||0!==n.index?-1:0,o=te(),l=re(),h=Ce(),t=i({className:w("subgroup"),role:"group"},T("subgroup")),y=d.isNotEmpty(n.node.children)&&I?e.createElement("ul",t,n.node.children.map((function(t,r){return e.createElement(L,{key:t.key||t.label,node:t,checkboxIcon:n.checkboxIcon,collapseIcon:n.collapseIcon,contextMenuSelectionKey:n.contextMenuSelectionKey,cx:w,disabled:n.disabled,dragdropScope:n.dragdropScope,expandIcon:n.expandIcon,expandedKeys:n.expandedKeys,index:r,isNodeLeaf:n.isNodeLeaf,last:r===n.node.children.length-1,metaKeySelection:n.metaKeySelection,nodeTemplate:n.nodeTemplate,onClick:n.onClick,onCollapse:n.onCollapse,onContextMenu:n.onContextMenu,onContextMenuSelectionChange:n.onContextMenuSelectionChange,onDoubleClick:n.onDoubleClick,onDragEnd:n.onDragEnd,onDragStart:n.onDragStart,onDrop:n.onDrop,onDropPoint:n.onDropPoint,onExpand:n.onExpand,onPropagateUp:ee,onSelect:n.onSelect,onSelectionChange:n.onSelectionChange,onToggle:n.onToggle,onUnselect:n.onUnselect,originalOptions:n.originalOptions,parent:n.node,path:n.path+"-"+r,propagateSelectionDown:n.propagateSelectionDown,propagateSelectionUp:n.propagateSelectionUp,ptm:O,selectionKeys:n.selectionKeys,selectionMode:n.selectionMode,togglerTemplate:n.togglerTemplate})}))):null,v=i(D(D({ref:x,className:a(n.node.className,w("node",{isLeaf:k})),style:n.node.style,tabIndex:r,role:"treeitem","aria-label":C,"aria-level":n.level,"aria-expanded":I,"aria-checked":l,"aria-setsize":n.node.children?n.node.children.length:0,"aria-posinset":n.index+1,onKeyDown:V},"aria-expanded",I),"aria-selected",l||o),T("node")),e.createElement("li",v,h,y));if(n.dragdropScope&&!n.disabled){var De=ke(-1),Oe=n.last?ke(1):null;return e.createElement(e.Fragment,null,De,Ie,Oe)}return Ie}));L.displayName="UITreeNode";function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function J(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=X(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function X(e,n){if(e){if("string"==typeof e)return B(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?B(e,n):void 0}}function B(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var V=e.memo(e.forwardRef((function(t,p){var s=e.useContext(n),f=K.getProps(t,s),g=N(e.useState(""),2),m=g[0],y=g[1],v=N(e.useState(f.expandedKeys),2),b=v[0],x=v[1],S=e.useRef(null),k=e.useRef([]),C=e.useRef(null),I=e.useRef(!1),D=f.onFilterValueChange?f.filterValue:m,O=f.onToggle?f.expandedKeys:b,w=e.useRef(null),T=K.setMetaData({props:f,state:{filterValue:D,expandedKeys:O}}),M=T.ptm,P=T.cx;r(K.css.styles,T.isUnstyled,{name:"tree"});var j,A,U,R={filter:function(e){return ee(e)},reset:function(){return le()}},X=function(e){var n=e.originalEvent,t=e.navigateFocusToChild;f.onToggle?f.onToggle({originalEvent:n,value:e.value}):(t&&(w.current=n),x(e.value))};j=function(){if(w.current){var e=w.current,n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1].children[0];n.tabIndex="-1",t.tabIndex="0",t.focus(),w.current=null}},A=[O],U=e.useRef(!1),e.useEffect((function(){if(U.current)return j&&j();U.current=!0}),A);var B=function(e){C.current={path:e.path,index:e.index}},V=function(){C.current=null},_=function e(n){if(Array.isArray(n))return n.map(e);if(n&&Object.getPrototypeOf(n)===Object.prototype){var t={};for(var r in n)t[r]="data"!==r?e(n[r]):n[r];return t}return n},H=function(e){if(Y(C.current.path,e.path)){var n=_(f.value),t=C.current.path.split("-");t.pop();var r=Q(n,t),o=r?r.children[C.current.index]:n[C.current.index],l=Q(n,e.path.split("-"));l.children?l.children.push(o):l.children=[o],r?r.children.splice(C.current.index,1):n.splice(C.current.index,1),f.onDragDrop&&f.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:o,dropNode:l,dropIndex:e.index})}},$=function(e){if(q(e)){var n=_(f.value),t=C.current.path.split("-");t.pop();var r=e.path.split("-");r.pop();var o=Q(n,t),l=Q(n,r),a=o?o.children[C.current.index]:n[C.current.index],i=G(C.current.path,e.path);if(o?o.children.splice(C.current.index,1):n.splice(C.current.index,1),e.position<0){var c=i?C.current.index>e.index?e.index:e.index-1:e.index;l?l.children.splice(c,0,a):n.splice(c,0,a)}else l?l.children.push(a):n.push(a);f.onDragDrop&&f.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:a,dropNode:l,dropIndex:e.index})}},z=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},Y=function(e,n){return!!z(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},q=function(e){return!!z(C.current.path,e.path)&&(-1!==e.position||!G(C.current.path,e.path)||C.current.index+1!==e.index)},G=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},Q=function e(n,t){if(0===t.length)return null;var r=parseInt(t[0],10),o=n.children?n.children[r]:n[r];return 1===t.length?o:(t.shift(),e(o,t))},W=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},Z=function(e){13===e.which&&e.preventDefault()},ee=function(e){I.current=!0;var n=e.target.value;f.onFilterValueChange?f.onFilterValueChange({originalEvent:e,value:n}):y(n)},ne=function(e){y(d.isNotEmpty(e)?e:""),te()},te=function(){if(I.current){if(d.isEmpty(D))k.current=f.value;else{k.current=[];var e,n=f.filterBy.split(","),t=D.toLocaleLowerCase(f.filterLocale),r="strict"===f.filterMode,o=J(f.value);try{for(o.s();!(e=o.n()).done;){var l=F({},e.value),a={searchFields:n,filterText:t,isStrictMode:r};(r&&(re(l,a)||oe(l,a))||!r&&(oe(l,a)||re(l,a)))&&k.current.push(l)}}catch(e){o.e(e)}finally{o.f()}}I.current=!1}},re=function(e,n){if(e){var t=!1;if(e.children){var r=E(e.children);e.children=[];var o,l=J(r);try{for(l.s();!(o=l.n()).done;){var a=F({},o.value);oe(a,n)&&(t=!0,e.children.push(a))}}catch(e){l.e(e)}finally{l.f()}}if(t)return e.expanded=!0,!0}},oe=function(e,n){var t,r=n.searchFields,o=n.filterText,l=n.isStrictMode,a=!1,i=J(r);try{for(i.s();!(t=i.n()).done;){String(d.resolveFieldData(e,t.value)).toLocaleLowerCase(f.filterLocale).indexOf(o)>-1&&(a=!0)}}catch(e){i.e(e)}finally{i.f()}return(!a||l&&!W(e))&&(a=re(e,{searchFields:r,filterText:o,isStrictMode:l})||a),a},le=function(){y("")};e.useImperativeHandle(p,(function(){return{props:f,filter:ne,getElement:function(){return S.current}}}));var ae=function(n,t,r){return e.createElement(L,{hostName:"Tree",key:n.key||n.label,node:n,level:f.level+1,originalOptions:f.value,index:t,last:r,path:String(t),checkboxIcon:f.checkboxIcon,collapseIcon:f.collapseIcon,contextMenuSelectionKey:f.contextMenuSelectionKey,cx:P,disabled:f.disabled,dragdropScope:f.dragdropScope,expandIcon:f.expandIcon,expandedKeys:O,isNodeLeaf:W,metaKeySelection:f.metaKeySelection,nodeTemplate:f.nodeTemplate,onClick:f.onNodeClick,onCollapse:f.onCollapse,onContextMenu:f.onContextMenu,onContextMenuSelectionChange:f.onContextMenuSelectionChange,onDoubleClick:f.onNodeDoubleClick,onDragEnd:V,onDragStart:B,onDrop:H,onDropPoint:$,onExpand:f.onExpand,onSelect:f.onSelect,onSelectionChange:f.onSelectionChange,onToggle:X,onUnselect:f.onUnselect,propagateSelectionDown:f.propagateSelectionDown,propagateSelectionUp:f.propagateSelectionUp,ptm:M,selectionKeys:f.selectionKeys,selectionMode:f.selectionMode,togglerTemplate:f.togglerTemplate})},ie=function(){f.filter&&(I.current=!0,te());var e=f.filter&&k.current?k.current:f.value;return e.map((function(n,t){return ae(n,t,t===e.length-1)}))},ce=function(){if(f.filter){var n=d.isNotEmpty(D)?D:"",t=i({className:P("searchIcon")},M("searchIcon")),r=u.getJSXIcon(f.filterIcon||e.createElement(o,t),F({},t),{props:f}),l=i({className:P("filterContainer")},M("filterContainer")),a=i({type:"text",value:n,autoComplete:"off",className:P("input"),placeholder:f.filterPlaceholder,"aria-label":f.filterPlaceholder,onKeyDown:Z,onChange:ee,disabled:f.disabled},M("input")),c=e.createElement("div",l,e.createElement("input",a),r);if(f.filterTemplate)c=d.getJSXElement(f.filterTemplate,{className:"p-tree-filter-container",element:c,filterOptions:R,filterInputKeyDown:Z,filterInputChange:ee,filterIconClassName:"p-dropdown-filter-icon",props:f});return e.createElement(e.Fragment,null,c)}return null},de=K.getOtherProps(f),ue=d.reduceKeys(de,c.ARIA_PROPS),pe=function(){if(f.loading){var n=i({className:P("loadingIcon")},M("loadingIcon")),t=f.loadingIcon||e.createElement(l,h({},n,{spin:!0})),r=u.getJSXIcon(t,F({},n),{props:f}),o=i({className:P("loadingOverlay")},M("loadingOverlay"));return e.createElement("div",o,r)}return null}(),se=function(){if(f.value){var n=ie(),t=i(F({className:a(f.contentClassName,P("container")),role:"tree","aria-label":f.ariaLabel,"aria-labelledby":f.ariaLabelledBy,style:f.contentStyle},ue),M("container"));return e.createElement("ul",t,n)}return null}(),fe=function(){if(f.showHeader){var n=ce(),t=n;if(f.header)t=d.getJSXElement(f.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:Z,onChange:ee},filterElement:n,element:t,props:f});var r=i({className:P("header")},M("header"));return e.createElement("div",r,t)}return null}(),ge=function(){var n=d.getJSXElement(f.footer,f),t=i({className:P("footer")},M("footer"));return e.createElement("div",t,n)}(),me=i({ref:S,className:a(f.className,P("root")),style:f.style,id:f.id},K.getOtherProps(f),M("root"));return e.createElement("div",me,pe,fe,se,ge)})));V.displayName="Tree";export{V as Tree};
