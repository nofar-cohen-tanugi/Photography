import*as e from"react";import n,{PrimeReactContext as t,ariaLabel as r}from"primereact/api";import{ComponentBase as i,useHandleStyle as o}from"primereact/componentbase";import{useEventListener as u,useResizeListener as a,useMountEffect as c,useUpdateEffect as l,useUnmountEffect as s}from"primereact/hooks";import{BarsIcon as m}from"primereact/icons/bars";import{classNames as f,mergeProps as p,ObjectUtils as d,IconUtils as b,DomHandler as v,UniqueComponentId as y,ZIndexUtils as g}from"primereact/utils";import{AngleDownIcon as x}from"primereact/icons/angledown";import{AngleRightIcon as I}from"primereact/icons/angleright";import{Ripple as h}from"primereact/ripple";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function k(e,n){if("object"!==E(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function S(e){var n=k(e,"string");return"symbol"===E(n)?n:String(n)}function w(e,n,t){return(n=S(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function P(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o,u,a=[],c=!0,l=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=o.call(t)).done)&&(a.push(r.value),a.length!==n);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function K(e,n){if(e){if("string"==typeof e)return N(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?N(e,n):void 0}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,n){return O(e)||P(e,n)||K(e,n)||j()}var A=i.extend({defaultProps:{__TYPE:"Menubar",id:null,model:null,style:null,className:null,start:null,ariaLabel:null,ariaLabelledBy:null,onFocus:null,onBlur:null,submenuIcon:null,menuIcon:null,end:null,children:void 0},css:{classes:{start:"p-menubar-start",end:"p-menubar-end",button:"p-menubar-button",root:function(e){return f("p-menubar p-component",{"p-menubar-mobile-active":e.mobileActiveState})},separator:"p-menuitem-separator",icon:"p-menuitem-icon",label:"p-menuitem-text",submenuIcon:"p-submenu-icon",menuitem:function(e){return f("p-menuitem",{"p-menuitem-active p-highlight":e.active,"p-focus":e.focused,"p-disabled":e.disabled})},menu:"p-menubar-root-list",content:"p-menuitem-content",submenu:"p-submenu-list",action:function(e){return f("p-menuitem-link",{"p-disabled":e.disabled})}},styles:"\n@layer primereact {\n    .p-menubar {\n        display: flex;\n        align-items: center;\n    }\n\n    .p-menubar ul {\n        margin: 0;\n        padding: 0;\n        list-style: none;\n    }\n\n    .p-menubar .p-menuitem-link {\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        text-decoration: none;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-menubar .p-menuitem-text {\n        line-height: 1;\n    }\n\n    .p-menubar .p-menuitem {\n        position: relative;\n    }\n\n    .p-menubar-root-list {\n        display: flex;\n        align-items: center;\n        flex-wrap: wrap;\n    }\n\n    .p-menubar-root-list > li ul {\n        display: none;\n        z-index: 1;\n    }\n\n    .p-menubar-root-list > .p-menuitem-active > .p-submenu-list {\n        display: block;\n    }\n\n    .p-menubar .p-submenu-list {\n        display: none;\n        position: absolute;\n        z-index: 1;\n    }\n\n    .p-menubar .p-submenu-list > .p-menuitem-active > .p-submenu-list {\n        display: block;\n        left: 100%;\n        top: 0;\n    }\n\n    .p-menubar .p-submenu-list .p-menuitem .p-menuitem-content .p-menuitem-link .p-submenu-icon {\n        margin-left: auto;\n    }\n\n    .p-menubar .p-menubar-end {\n        margin-left: auto;\n        align-self: center;\n    }\n\n    .p-menubar-button {\n        display: none;\n        cursor: pointer;\n        align-items: center;\n        justify-content: center;\n        text-decoration: none;\n    }\n}\n"}});function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var M=e.memo(e.forwardRef((function(n,t){var r=n.ptm,i=n.cx,o=function(e,t,i){return r(t,{props:n,hostName:n.hostName,context:{item:e,index:i,active:m(e),focused:g(e),disabled:y(e),level:n.level}})},u=function(e,t){y(t)||n.mobileActive?e.preventDefault():n.onItemMouseEnter&&n.onItemMouseEnter({originalEvent:e,processedItem:t})},a=function(e,n){var t=n.item;y(n)?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),c({originalEvent:e,processedItem:n,isFocus:!0}))},c=function(e){n.onLeafClick&&n.onLeafClick(e)},l=function(e){return"".concat(n.id,"_").concat(e.key)},s=function(e,n,t){return e&&e.item?d.getItemValue(e.item[n],t):void 0},m=function(e){return n.activeItemPath.some((function(n){return n.key===e.key}))},v=function(e){return!1!==s(e,"visible")},y=function(e){return s(e,"disabled")},g=function(e){return n.focusedItemId===l(e)},E=function(e){return d.isNotEmpty(e.items)},k=function(e){return e-n.model.slice(0,e).filter((function(e){return v(e)&&s(e,"separator")})).length+1},S=function(t){var o=n.id+"_separator_"+t,u=p({id:o,key:o,className:i("separator"),role:"separator"},r("separator",{hostName:n.hostName}));return e.createElement("li",u)},O=function(t){var o=t&&t.items;return o?e.createElement(M,{id:n.id,hostName:n.hostName,menuProps:n.menuProps,level:n.level+1,model:o,activeItemPath:n.activeItemPath,focusedItemId:n.focusedItemId,onLeafClick:c,onItemMouseEnter:n.onItemMouseEnter,submenuIcon:n.submenuIcon,ptm:r,style:{display:m(t)?"block":"none"},cx:i}):null},P=function(t,r){var c=t.item;if(!v(t))return null;var S=l(t),P=m(t),N=g(t),K=y(t)||!1,j=E(t),D=f("p-menuitem-link",{"p-disabled":K}),A=f("p-menuitem-icon",s(t,"icon")),C=p({className:i("icon")},o(t,"icon",r)),M=b.getJSXIcon(c.icon,L({},C),{props:n.menuProps}),T=p({className:i("label")},o(t,"label",r)),R=c.label&&e.createElement("span",T,c.label),B=s(t,"items"),F=p({className:i("submenuIcon")},o(t,"submenuIcon",r)),_=B&&b.getJSXIcon(n.root?n.submenuIcon||e.createElement(x,F):n.submenuIcon||e.createElement(I,F),L({},F),{props:L({menuProps:n.menuProps},n)}),J=O(t),X=p({href:c.url||"#",tabIndex:"-1","aria-hidden":"true",className:i("action",{disabled:K}),onFocus:function(e){return e.stopPropagation()},target:s(t,"target"),"aria-haspopup":null!=B},o(t,"action",r)),z=e.createElement("a",X,M,R,_,e.createElement(h,null));c.template&&(z=d.getJSXElement(c.template,c,{className:D,labelClassName:"p-menuitem-text",iconClassName:A,submenuIconClassName:"p-submenu-icon",element:z,props:n}));var U=p({onClick:function(e){return a(e,t)},onMouseEnter:function(e){return u(e,t)},className:i("content")},o(t,"content",r)),V=s(t,"className"),H=p(w({id:S,key:S,role:"menuitem","aria-label":c.label,"aria-disabled":K,"aria-expanded":j?P:void 0,"aria-haspopup":j&&!c.url?"menu":void 0,"aria-level":n.level+1,"aria-setsize":n.model.filter((function(e){return v(e)&&!s(e,"separator")})).length,"aria-posinset":k(r),"data-p-highlight":P,"data-p-focused":N,"data-p-disabled":K,className:f(V,i("menuitem",{active:P,focused:N,disabled:K}))},"data-p-disabled",K||!1),o(t,"menuitem",r));return e.createElement("li",H,e.createElement("div",U,z),J)},N=n.root?"menubar":"menu",K=n.root?"menu":"submenu",j=n.root?"0":null,D=n.model?n.model.map((function(e,n){return s(e,"separator")?S(n):P(e,n)})):null,A=p({ref:t,className:i(K),level:n.level,onFocus:n.onFocus,onBlur:n.onBlur,onKeyDown:n.onKeyDown,id:n.id,tabIndex:j,"aria-activedescendant":n.ariaActivedescendant,style:n.style,role:N},r(K));return e.createElement("ul",A,D)})));function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}M.displayName="MenubarSub";var B=e.memo(e.forwardRef((function(i,x){var I=e.useContext(t),h=A.getProps(i,I),E=D(e.useState(h.id),2),k=E[0],S=E[1],O=D(e.useState(!1),2),P=O[0],N=O[1],K=D(e.useState(!1),2),j=K[0],C=K[1],L=D(e.useState({index:-1,level:0,parentKey:""}),2),T=L[0],B=L[1],F=D(e.useState(null),2),_=F[0],J=F[1],X=D(e.useState([]),2),z=X[0],U=X[1],V=D(e.useState([]),2),H=V[0],W=V[1],Z=D(e.useState([]),2),Y=Z[0],$=Z[1],q=D(e.useState(!1),2),G=q[0],Q=q[1],ee=D(e.useState(!1),2),ne=ee[0],te=ee[1],re=e.useRef(null),ie=e.useRef(null),oe=e.useRef(null),ue=e.useRef(""),ae=e.useRef(null),ce=e.useRef(!1),le=A.setMetaData({props:h,state:{id:k,mobileActive:P}}),se=le.ptm,me=le.cx;o(A.css.styles,le.isUnstyled,{name:"menubar"});var fe=D(u({type:"click",listener:function(e){he(e)&&(re.current&&!re.current.contains(e.target)&&Ie())}}),2),pe=fe[0],de=fe[1],be=D(a({listener:function(e){v.isTouchDevice()||Ie(e)}}),2),ve=be[0],ye=be[1],ge=function(e){P?(N(!1),Ie()):(N(!0),setTimeout((function(){xe()}),1)),e.preventDefault()},xe=function(){B({index:He(),level:0,parentKey:""}),v.focus(ie.current)},Ie=function(e){P&&(N(!1),setTimeout((function(){v.focus(oe.current)}),0)),U([]),B({index:-1,level:0,parentKey:""}),e&&v.focus(ie.current),te(!1)},he=function(e){return ie.current!==e.target&&!ie.current.contains(e.target)&&oe.current!==e.target&&!oe.current.contains(e.target)},Ee=function(e,n){return e?d.getItemValue(e[n]):void 0},ke=function(e){return Ee(e,"separator")},Se=function(e){return e?Ee(e.item,"label"):void 0},we=function(e){return e&&d.isNotEmpty(e.items)},Oe=function(e){var n=e.processedItem,t=e.isFocus;if(!d.isEmpty(n)){var r=n.index,i=n.key,o=n.level,u=n.parentKey,a=d.isNotEmpty(n.items),c=z.filter((function(e){return e.parentKey!==u&&e.parentKey!==i}));a&&c.push(n),B({index:r,level:o,parentKey:u}),U(c),a&&te(!0),t&&v.focus(ie.current)}},Pe=function(e){var n=H[T.index];if(n?d.isEmpty(n.parent):null){we(n)&&(Oe({originalEvent:e,processedItem:n}),B({index:-1,parentKey:n.key}),setTimeout((function(){return Q(!0)}),0))}else{var t=-1!==T.index?ze(T.index):He();Ye(t)}e.preventDefault()},Ne=function(e){var n=H[T.index];if(d.isEmpty(n.parent)){we(n)&&(Oe({originalEvent:e,processedItem:n}),B({index:-1,parentKey:n.key}),ce.current=!0,setTimeout((function(){return Q(!0)}),0))}else{var t=z.find((function(e){return e.key===n.parentKey}));if(0===T.index&&t&&""===t.parentKey)B({index:-1,parentKey:t?t.parentKey:""}),ue.current="",Ke(e);else{var r=-1!==T.index?Ue(T.index):We();Ye(r)}}e.preventDefault()},Ke=function(e){var n=H[T.index],t=n?z.find((function(e){return e.key===n.parentKey})):null;if(t)Oe({originalEvent:e,processedItem:t}),U(z.filter((function(e){return e.key!==t.key})));else{var r=-1!==T.index?Ue(T.index):We();Ye(r)}e.preventDefault()},je=function(e){var n=H[T.index];if(n?z.find((function(e){return e.key===n.parentKey})):null){we(n)&&(Oe({originalEvent:e,processedItem:n}),B({index:-1,parentKey:n.key}),setTimeout((function(){return Q(!0)}),0))}else{var t=-1!==T.index?ze(T.index):He();Ye(t)}e.preventDefault()},De=function(e){Ye(Je()),e.preventDefault()},Ae=function(e){Ye(Xe()),e.preventDefault()},Ce=function(e){if(-1!==T.index){var n=v.findSingle(ie.current,'li[id="'.concat("".concat(_),'"]')),t=n&&v.findSingle(n,'a[data-pc-section="action"]');t?t.click():n&&n.click()}e.preventDefault()},Le=function(e){Ce(e)},Me=function(e){Ie(!0),B({focusedItemInfo:T,index:He()})},Te=function(e){if(-1!==T.index){var n=H[T.index];!we(n)&&Oe({originalEvent:e,processedItem:n})}Ie()},Re=function(e){return Be(e)&&Se(e).toLocaleLowerCase().startsWith(ue.current.toLocaleLowerCase())},Be=function(e){return!!e&&!Ee(e.item,"disabled")&&!ke(e.item)},Fe=function(e){return Be(e)&&_e(e)},_e=function(e){return z.some((function(n){return n.key===e.key}))},Je=function(){return H.findIndex((function(e){return Be(e)}))},Xe=function(){return d.findLastIndex(H,(function(e){return Be(e)}))},ze=function(e){var n=e<H.length-1?H.slice(e+1).findIndex((function(e){return Be(e)})):-1;return n>-1?n+e+1:e},Ue=function(e){var n=e>0?d.findLastIndex(H.slice(0,e),(function(e){return Be(e)})):-1;return n>-1?n:e},Ve=function(){return H.findIndex((function(e){return Fe(e)}))},He=function(){var e=Ve();return e<0?Je():e},We=function(){var e=Ve();return e<0?Xe():e},Ze=function(e,n){ue.current=(ue.current||"")+n;var t=-1,r=!1;return-1!==(t=-1!==T.index?-1===(t=H.slice(T.index).findIndex((function(e){return Re(e)})))?H.slice(0,T.index).findIndex((function(e){return Re(e)})):t+T.index:H.findIndex((function(e){return Re(e)})))&&(r=!0),-1===t&&-1===T.index&&(t=He()),-1!==t&&Ye(t),ae.current&&clearTimeout(ae.current),ae.current=setTimeout((function(){ue.current="",ae.current=null}),500),r},Ye=function(e){T.index!==e&&(B(R(R({},T),{},{index:e})),$e())},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=-1!==e?"".concat(k,"_").concat(e):_,t=v.findSingle(ie.current,'li[id="'.concat(n,'"]'));t&&t.scrollIntoView&&t.scrollIntoView({block:"nearest",inline:"start"})},qe=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=[];return n&&n.forEach((function(n,u){var a=(""!==i?i+"_":"")+u,c={item:n,index:u,level:t,key:a,parent:r,parentKey:i};c.items=e(n.items,t+1,c,a),o.push(c)})),o};c((function(){k||S(y())})),l((function(){P?(pe(),ve(),g.set("menu",ie.current,I&&I.autoZIndex||n.autoZIndex,I&&I.zIndex.menu||n.zIndex.menu)):(ye(),de(),g.clear(ie.current))}),[P]),l((function(){var e=qe(h.model||[],0,null,"");$(e)}),[h.model]),l((function(){var e=z.find((function(e){return e.key===T.parentKey}));W(e?e.items:Y)}),[z,T,Y]),l((function(){d.isNotEmpty(z)?(pe(),ve()):(de(),ye())}),[z]),l((function(){if(G){var e=-1!==T.index?ze(T.index):ce.current?Xe():He();Ye(e),ce.current=!1,Q(!1)}}),[G]),l((function(){J(-1!==T.index?"".concat(k).concat(d.isNotEmpty(T.parentKey)?"_"+T.parentKey:"","_").concat(T.index):null)}),[T]),s((function(){g.clear(ie.current)})),e.useImperativeHandle(x,(function(){return{props:h,toggle:ge,getElement:function(){return re.current},getRootMenu:function(){return ie.current},getMenuButton:function(){return oe.current}}}));var Ge=function(){if(h.start){var n=d.getJSXElement(h.start,h),t=p({className:me("start")},se("start"));return e.createElement("div",t,n)}return null}(),Qe=function(){if(h.end){var n=d.getJSXElement(h.end,h),t=p({className:me("end")},se("end"));return e.createElement("div",t,n)}return null}(),en=function(){if(h.model&&h.model.length<1)return null;var n=p(w(w(w(w({ref:oe,href:"#",tabIndex:"0","aria-haspopup":!!(P&&h.model&&h.model.lentgh>0),"aria-expanded":P,"aria-label":r("navigation"),"aria-controls":k,role:"button"},"tabIndex",0),"className",me("button")),"onKeyDown",(function(e){var n;("Enter"===(n=e).code||"Space"===n.code)&&ge(n)})),"onClick",(function(e){return ge(e)})),se("button")),t=p(se("popupIcon")),i=b.getJSXIcon(h.menuIcon||e.createElement(m,t),R({},t),{props:h});return e.createElement("a",n,i)}(),nn=e.createElement(M,{hostName:"Menubar",ariaActivedescendant:j?_:void 0,level:0,id:k,ref:ie,menuProps:h,model:Y,onLeafClick:function(e){var n=e.originalEvent,t=e.processedItem,r=we(t),i=d.isEmpty(t.parent);if(_e(t)){var o=t.index,u=t.key,a=t.level,c=t.parentKey;U(z.filter((function(e){return u!==e.key&&u.startsWith(e.key)}))),B({index:o,level:a,parentKey:c}),r||te(!i),setTimeout((function(){v.focus(ie.current),r&&te(!0)}),0)}else if(r)v.focus(ie.current),Oe({originalEvent:n,processedItem:t});else{var l=i?t:z.find((function(e){return""===e.parentKey})),s=l?l.index:-1;Ie(n),B({index:s,parentKey:l?l.parentKey:""}),N(!1)}},onItemMouseEnter:function(e){!P&&ne&&Oe(e)},onFocus:function(e){C(!0),B(-1!==T.index?T:{index:He(),level:0,parentKey:""}),h.onFocus&&h.onFocus(e)},onBlur:function(e){C(!1),B({index:-1,level:0,parentKey:""}),ue.current="",te(!1),h.onBlur&&h.onBlur(e)},onKeyDown:function(e){var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":Pe(e);break;case"ArrowUp":Ne(e);break;case"ArrowLeft":Ke(e);break;case"ArrowRight":je(e);break;case"Home":De(e);break;case"End":Ae(e);break;case"Space":Le(e);break;case"Enter":Ce(e);break;case"Escape":Me();break;case"Tab":Te(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!n&&d.isPrintableCharacter(e.key)&&Ze(e,e.key)}},root:!0,activeItemPath:z,focusedItemId:j?_:void 0,submenuIcon:h.submenuIcon,ptm:se,cx:me}),tn=p({id:h.id,ref:re,className:f(h.className,me("root",{mobileActiveState:P})),style:h.style},A.getOtherProps(h),se("root"));return e.createElement("div",tn,Ge,en,nn,Qe)})));B.displayName="Menubar";export{B as Menubar};
